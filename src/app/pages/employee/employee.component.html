<div class="flex items-center mb-4 md:hidden">
  <h1 class="text-2xl font-medium text-fuchsia-950 flex items-center">
    Employee
  </h1>
</div>

<div class="w-full mb-4">
  <form
    [formGroup]="searchForm"
    (submit)="search()"
    class="flex flex-col md:flex-row gap-2 justify-between"
  >
    <div class="flex flex-col md:flex-row gap-2">
      <div class="relative">
        <div
          class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
        >
          <i class="fa-solid fa-magnifying-glass text-gray-300"></i>
        </div>
        <input
          type="text"
          class="focus:outline-none w-full placeholder:text-gray-300 border border-gray-300 pl-10 pr-3 py-1.5 rounded-lg"
          formControlName="name"
          placeholder="Search"
        />
      </div>
      <div class="relative md:w-44">
        <select
          id="status"
          formControlName="status"
          class="w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:outline-none transition-all duration-200 appearance-none"
        >
          <option value="">All Status</option>
          <option value="active">Active</option>
          <option value="probation">Probation</option>
          <option value="resigned">Resigned</option>
        </select>
        <div
          class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"
        >
          <i class="fa-solid fa-chevron-down text-gray-400"></i>
        </div>
      </div>
      <div class="relative md:w-44">
        <select
          id="department_id"
          formControlName="department_id"
          class="w-full px-3 py-1.5 border border-gray-300 rounded-lg focus:outline-none transition-all duration-200 appearance-none"
        >
          <option [ngValue]="0">All Department</option>
          @for (department of departments; track department.id) {
          <option [ngValue]="department.id">{{ department.name }}</option>
          }
        </select>
        <div
          class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"
        >
          <i class="fa-solid fa-chevron-down text-gray-400"></i>
        </div>
      </div>
    </div>
    <button
      type="submit"
      class="bg-fuchsia-600 text-white px-5 py-1.5 rounded-lg hover:opacity-90 focus:outline-none focus:ring-1 focus:ring-fuchsia-500 focus:border-fuchsia-500 transition-all duration-200 font-medium shadow-lg transform hover:-translate-y-0.5"
    >
      Search
    </button>
  </form>
</div>

<div class="w-full overflow-x-auto">
  <table class="w-max min-w-full p-5 rounded-lg shadow-sm bg-white">
    <thead>
      <tr class="text-left text-gray-400">
        <th class="pl-8 pr-4 py-2">#</th>
        <th class="px-4 py-2">Name</th>
        <th class="px-4 py-2">Position</th>
        <th class="px-4 py-2">Department</th>
        <th class="px-4 py-2">Hired Date</th>
        <th class="px-4 py-2">Status</th>
        <th class="px-4 py-2 text-center">
          <i class="fa-solid fa-ellipsis text-gray-400"></i>
        </th>
      </tr>
    </thead>
    <tbody>
      @for(employee of employees; track employee.id; let idx = $index){
      <tr class="border-y border-gray-200">
        <td class="pl-8 pr-4 py-2">{{ idx + 1 }}</td>
        <td class="px-4 py-2">
          {{ employee.user.name }}
        </td>
        <td class="px-4 py-2 text-nowrap">
          {{ employee.position }}
        </td>
        <td class="px-4 py-2 text-nowrap">
          {{ employee.department.name }}
        </td>
        <td class="px-4 py-2">
          {{ employee.join_date | date : "shortDate" }}
        </td>
        <td class="px-4 py-2">
          {{ employee.status | titlecase }}
        </td>
        <td
          class="px-4 py-2 flex flex-row gap-2 justify-center items-center h-full text-gray-500"
        >
          <!-- edit -->
          <div
            (click)="openEditModal(employee)"
            class="hover:bg-green-100 px-2.5 py-1 rounded hover:text-green-500"
          >
            <i class="fa-solid fa-pen text-xs"></i>
          </div>
          <!-- delete -->
          <div
            class="hover:bg-rose-100 px-2.5 py-1 rounded hover:text-rose-500"
          >
            <i class="fa-solid fa-trash text-xs"></i>
          </div>
        </td>
      </tr>
      }
    </tbody>
  </table>
</div>

@if(isEdit){
<app-employee-edit
  [employee]="selectedEmployee"
  (cancel)="closeEditModal()"
  (refresh)="getEmployees()"
></app-employee-edit>
}
